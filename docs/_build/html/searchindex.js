Search.setIndex({docnames:["acquire_rl","data","index","models","modules","options","rl_env","trainer","util"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,sphinx:56},filenames:["acquire_rl.rst","data.rst","index.rst","models.rst","modules.rst","options.rst","rl_env.rst","trainer.rst","util.rst"],objects:{"":{acquire_rl:[0,0,0,"-"],data:[1,0,0,"-"],models:[3,0,0,"-"],options:[5,0,0,"-"],rl_env:[6,0,0,"-"],trainer:[7,0,0,"-"],util:[8,0,0,"-"]},"data.base_data_loader":{get_test_loader:[1,1,1,""],get_train_valid_loader:[1,1,1,""]},"data.dicom_data_loader":{DicomDataTransform:[1,2,1,""],Slice:[1,2,1,""]},"data.masking_utils":{BasicMaskFunc:[1,2,1,""],MaskFunc:[1,2,1,""],SymmetricLowToHighMaskFunc:[1,2,1,""],SymmetricUniformChoiceMaskFunc:[1,2,1,""],SymmetricUniformGridMaskFunc:[1,2,1,""],UniformGridMaskFunc:[1,2,1,""],get_mask_func:[1,1,1,""]},"data.masking_utils.BasicMaskFunc":{create_lf_focused_mask:[1,3,1,""]},"data.masking_utils.MaskFunc":{create_lf_focused_mask:[1,3,1,""]},"data.masking_utils.SymmetricLowToHighMaskFunc":{create_lf_focused_mask:[1,3,1,""]},"data.masking_utils.SymmetricUniformChoiceMaskFunc":{create_lf_focused_mask:[1,3,1,""]},"data.masking_utils.SymmetricUniformGridMaskFunc":{create_lf_focused_mask:[1,3,1,""]},"data.masking_utils.UniformGridMaskFunc":{create_lf_focused_mask:[1,3,1,""]},"data.raw_data_loader":{RawDataTransform:[1,2,1,""],RawSliceData:[1,2,1,""],fftshift:[1,1,1,""],ifftshift:[1,1,1,""],roll:[1,1,1,""]},"models.evaluator":{EvaluatorNetwork:[3,2,1,""],SimpleSequential:[3,2,1,""],SpectralMapDecomposition:[3,2,1,""],test_evaluator:[3,1,1,""]},"models.evaluator.EvaluatorNetwork":{forward:[3,3,1,""]},"models.evaluator.SimpleSequential":{forward:[3,3,1,""]},"models.evaluator.SpectralMapDecomposition":{forward:[3,3,1,""]},"models.fft_utils":{GANLossKspace:[3,2,1,""],center_crop:[3,1,1,""],dicom_to_0_1_range:[3,1,1,""],fft:[3,1,1,""],fftshift:[3,1,1,""],gaussian_nll_loss:[3,1,1,""],ifft:[3,1,1,""],ifftshift:[3,1,1,""],preprocess_inputs:[3,1,1,""],rfft:[3,1,1,""],roll:[3,1,1,""],to_magnitude:[3,1,1,""]},"models.fft_utils.GANLossKspace":{get_target_tensor:[3,3,1,""]},"models.reconstruction":{ReconstructorNetwork:[3,2,1,""],ResnetBlock:[3,2,1,""],get_norm_layer:[3,1,1,""],init_func:[3,1,1,""],test:[3,1,1,""]},"models.reconstruction.ReconstructorNetwork":{data_consistency:[3,3,1,""],embed_mask:[3,3,1,""],forward:[3,3,1,""]},"models.reconstruction.ResnetBlock":{build_conv_block:[3,3,1,""],forward:[3,3,1,""]},"options.base_options":{BaseOptions:[5,2,1,""]},"options.base_options.BaseOptions":{gather_options:[5,3,1,""],initialize:[5,3,1,""],parse:[5,3,1,""],print_options:[5,3,1,""]},"options.rl_options":{RLOptions:[5,2,1,""]},"options.rl_options.RLOptions":{initialize:[5,3,1,""],parse:[5,3,1,""]},"options.test_options":{TestOptions:[5,2,1,""]},"options.test_options.TestOptions":{initialize:[5,3,1,""]},"options.train_options":{TrainOptions:[5,2,1,""]},"options.train_options.TrainOptions":{initialize:[5,3,1,""]},"rl_env.ReconstructionEnv":{compute_new_mask:[6,3,1,""],compute_score:[6,3,1,""],convert_num_cols_to_acceleration:[6,3,1,""],get_evaluator_action:[6,3,1,""],get_num_active_columns_in_obs:[6,3,1,""],render:[6,3,1,""],reset:[6,3,1,""],set_testing:[6,3,1,""],set_training:[6,3,1,""],step:[6,3,1,""]},"trainer.Trainer":{create_checkpoint:[7,3,1,""],discriminator_loss:[7,3,1,""],get_loaders:[7,3,1,""],inference:[7,3,1,""],load_from_checkpoint_if_present:[7,3,1,""],load_weights_from_given_checkpoint:[7,3,1,""],update:[7,3,1,""]},"util.util":{compute_mse:[8,1,1,""],compute_nmse:[8,1,1,""],compute_psnrs:[8,1,1,""],compute_ssims:[8,1,1,""],create_grid_from_tensor:[8,1,1,""],gray2heatmap:[8,1,1,""],tensor2im:[8,1,1,""]},acquire_rl:{get_experiment_str:[0,1,1,""],get_policy:[0,1,1,""],main:[0,1,1,""]},data:{base_data_loader:[1,0,0,"-"],create_data_loaders:[1,1,1,""],dicom_data_loader:[1,0,0,"-"],masking_utils:[1,0,0,"-"],raw_data_loader:[1,0,0,"-"]},models:{evaluator:[3,0,0,"-"],fft_utils:[3,0,0,"-"],reconstruction:[3,0,0,"-"]},options:{base_options:[5,0,0,"-"],rl_options:[5,0,0,"-"],test_options:[5,0,0,"-"],train_options:[5,0,0,"-"]},rl_env:{ReconstructionEnv:[6,2,1,""],load_checkpoint:[6,1,1,""]},trainer:{Trainer:[7,2,1,""],run_validation_and_update_best_checkpoint:[7,1,1,""],save_checkpoint_function:[7,1,1,""],save_regular_checkpoint:[7,1,1,""]},util:{util:[8,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method"},terms:{"class":[1,2,3,5,6,7,8],"final":[2,6],"float":[2,6],"function":[2,3,6],"int":[2,6],"new":[2,6],"return":[2,3,6,8],"static":6,"super":[2,6],"true":[2,3,6,8],"while":3,And:[2,6],That:[2,6],The:[2,6],_current_mask:[2,6],_evalu:[2,6],_ground_truth:[2,6],_order:[2,6],_reconstructor:[2,6],acceler:1,accord:[2,6],acquire_rl:4,acquisit:[2,6],action:[2,6],activ:[2,6],add:[2,6],adding:[2,6],addition:[2,6],after:[2,6],afterward:3,all:[2,3,6],along:3,altern:[2,6],although:3,ani:7,ansi:[2,6],appli:2,argpars:[],arrai:[2,6],base:[1,3,5,6,7],base_data_load:4,base_opt:4,baseopt:5,basic:1,basicmaskfunc:1,batch:[3,7],batch_siz:[1,3,8],best_checkpoint:6,between:[2,6],bool:[2,6],budget:[2,6],build_conv_block:3,call:[2,3,6],can:[2,6],care:3,center_crop:3,center_fract:1,checkpoints_dir:6,choos:[2,6],cmap:8,color:[2,6],column:[2,6],comput:[2,3,6],compute_ms:8,compute_new_mask:[2,6],compute_nms:8,compute_psnr:8,compute_scor:[2,6],compute_ssim:8,concaten:3,configur:[2,6],consumpt:[2,6],contain:[2,6],content:4,contrib:7,convent:[2,6],convert:8,convert_num_cols_to_acceler:6,core:6,creat:[2,3,6],create_checkpoint:7,create_data_load:1,create_grid_from_tensor:8,create_lf_focused_mask:1,cuda:8,current:[2,6],custom_split:1,data:[2,3,4,6,7],data_consist:3,dataload:7,dataroot:[2,3,6],dataset:[1,2,6],def:[2,6],defin:3,degre:3,devic:3,dicom:[2,6],dicom_data_load:4,dicom_root:1,dicom_to_0_1_rang:3,dicomdatatransform:1,dict:[2,6,7],differ:[2,6],dim:[1,3],directori:[2,6],discriminator_loss:7,displai:[2,6],dpgksdp:[],drop:[2,6],dropout_prob:3,each:3,elif:[2,6],els:[2,6],embed:3,embed_mask:3,embedding_dimens:3,engin:7,env:[0,2,6],environ:[2,6],episod:[2,6],escap:[2,6],evalu:[2,4,6],evaluator_dir:[2,6],evaluatornetwork:3,everi:3,exampl:[2,6],except:[2,6],fals:[1,2,3,6],fft:3,fft_util:4,fftshift:[1,3],field:[2,6],filenam:7,fill:[2,3,6],fixed_se:1,fjpso:[],follow:[2,6],format:[2,6],former:3,forward:3,fourier_spac:[2,6],frame:[2,6],from:[2,3,6],gamma:3,ganlosskspac:3,gather_opt:5,gaussian_nll_loss:3,get_evaluator_act:[2,6],get_experiment_str:0,get_load:7,get_mask_func:1,get_norm_lay:3,get_num_active_columns_in_ob:[2,6],get_polici:0,get_target_tensor:3,get_test_load:1,get_train_valid_load:1,given:[2,6],gjdspo:[],grad_ctx:3,gray2heatmap:8,grayimg:8,grid:8,ground:[2,3,6],ground_truth:[2,6],gym:[2,6],handler:7,has:[2,6],height:[3,8],high:3,hook:3,horizon:[2,6],how:[2,6],human:[2,6],ifft:3,ifft_shift:3,ifftshift:[1,3],ignit:7,ignor:3,imag:[2,3,6,8],image_spac:[2,6],img_width:3,implement:[2,6],imtyp:8,includ:[2,6],index:[2,6],infer:7,init_func:3,initi:[2,5,6],initial_num_lines_per_sid:[2,6],input:3,input_imag:8,instanc:3,instead:[2,3,6],is_test:1,jet:8,just:[2,6],k_space:[2,6],kei:[2,6],knee:[1,2,6],knee_raw:[2,6],latter:3,learn:2,let:2,like:[2,6],line:[2,6],list:[2,6],load:[2,6],load_checkpoint:6,load_from_checkpoint_if_pres:7,load_weights_from_given_checkpoint:7,logger:0,logvar:3,loop:[2,6],lowest:[2,6],magnitud:3,main:0,make:[2,6],mandatori:[2,6],mani:[2,6],map:3,mask:[2,3,6,7],mask_embed:3,mask_embed_dim:3,mask_func:1,mask_to_us:[2,6],mask_typ:1,maskfunc:1,masking_util:4,measur:3,metadata:[2,6],method:[2,6],mode:[2,6],model:4,modul:[2,4],mri:[2,6],mse:[2,6],must:[2,6],myenv:[2,6],n_downsampl:3,name:[2,6],namespac:[],ndarrai:[2,6],need:3,net1:3,net2:3,network:[2,3,6],newlin:[2,6],none:[1,2,3,6,7],norm_lay:3,norm_typ:3,normal:3,note:[2,6],noth:[2,6],num_col:[1,6],num_high_freq:1,num_low_freq:1,num_output_channel:3,num_rand_slic:1,num_row:8,num_test_imag:[2,6],num_train_imag:[2,6],num_volum:1,num_volumes_train:1,num_volumes_v:1,num_work:1,number:[2,6],number_of_cascade_block:3,number_of_conv_lay:3,number_of_decoder_output_channel:3,number_of_encoder_input_channel:3,number_of_filt:3,number_of_layers_residual_bottleneck:3,numpi:[2,6,8],object:[1,5,7],obs:[2,6],obs_typ:[2,6],observ:[2,6],ofkjgpodsjfop:[],old:[2,6],old_mask:[2,6],one:[2,3,6],opt:5,option:[1,2,3,4,6,7],options_:0,order:[2,6],over:[2,6],overridden:3,packag:[2,4],padding_typ:3,page:2,param:[2,6],paramet:[2,3,6,8],pars:5,parser:5,part:[2,6],pass:[2,3,6],path:[2,6],per:[2,6],perform:3,pin_memori:1,pixel:[2,6],pop:[2,6],possibl:[2,6],pred_and_gt:3,preprocess_input:3,prev_reconstruct:3,print_opt:5,problem:2,process:[2,6],progress_bar:7,progressbar:7,pth:6,rais:[2,6],random_num_lin:1,raw:[2,6],raw_data_load:4,rawdatatransform:1,rawslicedata:1,recip:3,recommend:[2,6],reconstruct:[2,4,6],reconstructed_imag:[3,7],reconstructionenv:[2,6],reconstructor:[2,3,6],reconstructor_dir:[2,6],reconstructor_ev:7,reconstructornetwork:3,reflect:3,regist:3,reinforc:2,rel:[2,6],render:[2,6],renorm:8,replic:3,repres:[2,6],represent:[2,6],reset:[2,6],reset_index:6,resnetblock:3,resolut:[1,3],respect:[2,6],result:[2,6],reward:[2,6],rfft:3,rgb:[2,6],rgb_arrai:[2,6],rl_env:[2,4],rl_option:4,rloption:5,rnl_param:1,roll:[1,3],root:1,run:3,run_validation_and_update_best_checkpoint:7,save:[2,6],save_checkpoint_funct:7,save_regular_checkpoint:7,scan:[2,6],scan_typ:1,score:[2,3,6],search:2,seed_per_imag:1,self:[2,6],sequenc:[2,6],set:[2,6],set_test:6,set_train:6,shape:[2,3,6,8],shift:[1,3],should:3,silent:3,simplenamespac:[2,6,7],simplesequenti:3,sinc:3,singl:[2,6],slice:1,solv:2,some:[2,6],space:[2,6],specifi:[2,6],spectral:3,spectralmapdecomposit:3,ssim:[2,6],start:[2,6],start_with_initial_mask:[2,6],state:[2,6],step:[2,6],store:[2,6],str:[2,6,7],string:[2,6],stringio:[2,6],style:[2,6],subclass:3,submodul:4,suitabl:[2,6],support:[2,6],sure:[2,6],symmetriclowtohighmaskfunc:1,symmetricuniformchoicemaskfunc:1,symmetricuniformgridmaskfunc:1,take:[2,3,6],target:[3,7],target_ev:7,target_is_r:3,techniqu:2,tensor2im:8,tensor:[2,3,6,8],tensor_of_imag:8,termin:[2,6],test:[2,3,6],test_evalu:3,test_opt:4,test_set:[2,6],testopt:5,text:[2,6],them:3,thi:[2,3,6],through:[2,6],to_magnitud:3,torch:[1,2,3,6,7],tqdm_logger:7,train:[1,2,6],train_opt:4,trainer:4,trainopt:5,transform:1,truth:[2,3,6],tupl:[2,6,7],turn:[2,6],two:[2,6],type:[2,6,7],uint8:8,uncertainti:3,uniformgridmaskfunc:1,updat:7,use:[2,6],use_bia:3,use_current_scor:[2,6],use_deconv:3,use_lsgan:3,use_mse_as_energi:3,use_reconstruct:[2,6],use_sigmoid:3,use_training_set:6,used:[2,3,6],usual:[2,6],util:[1,4,7],val:[2,6],val_engin:7,val_load:7,valid:[2,6],valu:[2,6],vari:[2,6],video:[2,6],where:[2,6],which:1,which_dataset:1,width:[3,8],window:[2,6],within:3,writer:0,you:2,your:[2,6],zero:[2,3,6],zero_filled_input:3},titles:["acquire_rl module","data package","Welcome to active_mri\u2019s documentation!","models package","Active_Acquisition","options package","rl_env module","trainer module","util package"],titleterms:{acquire_rl:0,acquisit:[],activ:[],active_acquisit:4,active_mri:2,base_data_load:1,base_opt:5,content:[1,3,5,8],data:1,dicom_data_load:1,document:2,evalu:3,fft_util:3,indic:2,masking_util:1,model:3,modul:[0,1,3,5,6,7,8],mri:[],option:5,packag:[1,3,5,8],raw_data_load:1,reconstruct:3,rl_env:6,rl_option:5,submodul:[1,3,5,8],tabl:2,test_opt:5,train_opt:5,trainer:7,util:8,welcom:2}})